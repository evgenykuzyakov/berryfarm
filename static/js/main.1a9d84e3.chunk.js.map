{"version":3,"sources":["App.js","index.js"],"names":["NearConfig","networkId","nodeUrl","bananaContractName","contractName","walletUrl","Avocado","role","aria-label","className","Banana","Cucumber","Near","Berry","App","props","state","connected","signedIn","accountId","account","claiming","bananaNum","_balanceRefreshTimer","_initNear","then","setState","_accountId","account_id","accountIndex","account_index","avocadoBalance","parseFloat","avocado_balance","this","_pixelCost","bananaBalance","banana_balance","bananaBalanceBN","BN","numPixels","num_pixels","farmingPreference","farming_preference","startTime","Date","getTime","avocadoPixels","bananaPixels","avocadoRewardPerMs","bananaRewardPerMs","bananaRewardPerMsBN","div","stats","_bananaContract","get_account","parseBananaAccount","_contract","cucumberAccount","Object","assign","nearBalanceBn","near_balance","cucumberBalanceBn","cucumber_balance","nearClaimed","near_claimed","Math","pow","_account","fetchState","accountNearBalance","_state","amount","nearBalance","toString","cucumberBalance","percent","totalSupply","forced","document","hidden","currentTime","get_next_reward_timestamp","nextReward","get_last_reward_timestamp","lastReward","get_expected_reward","expectedReward","get_stats","rawStats","totalSupplyBn","total_cucumber_balance","totalNearClaimed","total_near_claimed","totalNearRewarded","total_near_received","timeToNextRewards","timeFromLastRewards","refreshStats","getAccount","clearInterval","setInterval","t","keyStore","nearAPI","BrowserLocalStorageKeyStore","deps","near","_keyStore","_near","_walletConnection","getAccountId","viewMethods","changeMethods","get_pixel_cost","_pixelCostBN","refresh","requestSignIn","signOut","bananas","refreshAccountStats","trunc","mul","transfer_with_vault","receiver_id","payload","claim_near","content","onClick","logOut","toFixed","min","max","value","onChange","enableMobileNumericKeyboard","disabled","stakeBananas","b","claimNear","style","marginBottom","aria-hidden","statsContent","key","initialTime","direction","timeToUpdate","lastUnit","checkpoints","time","callback","Fragment","Hours","Minutes","formatValue","v","padStart","Seconds","Milliseconds","href","React","Component","Swap","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.1a9d84e3.chunk.js","sourcesContent":["import \"./App.scss\";\nimport React from 'react';\nimport BN from 'bn.js';\nimport * as nearAPI from 'near-api-js'\nimport InputNumber from 'react-input-number';\nimport Timer from 'react-compound-timer';\n\nconst IsMainnet = true;\nconst TestNearConfig = {\n  networkId: 'testnet',\n  nodeUrl: 'https://rpc.testnet.near.org',\n  bananaContractName: 'dev-1604708520705-2360364',\n  contractName: 'dev-1605908677227-6741841',\n  walletUrl: 'https://wallet.testnet.near.org',\n};\nconst MainNearConfig = {\n  networkId: 'mainnet',\n  nodeUrl: 'https://rpc.mainnet.near.org',\n  bananaContractName: 'berryclub.ek.near',\n  contractName: 'farm.berryclub.ek.near',\n  walletUrl: 'https://wallet.near.org',\n};\nconst NearConfig = IsMainnet ? MainNearConfig : TestNearConfig;\n\nconst Avocado = <span role=\"img\" aria-label=\"avocado\" className=\"berry\">ü•ë</span>;\nconst Banana = <span role=\"img\" aria-label=\"banana\" className=\"berry\">üçå</span>;\nconst Cucumber = <span role=\"img\" aria-label=\"cucumber\" className=\"berry\">ü•í</span>;\nconst Near = <span role=\"img\" aria-label=\"near\" className=\"berry\">‚ìÉ</span>;\n\nconst Berry = {\n  Avocado: 'Avocado',\n  Banana: 'Banana',\n};\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      connected: false,\n      signedIn: false,\n      accountId: null,\n      account: null,\n      claiming: false,\n      bananaNum: 1,\n    };\n    this._balanceRefreshTimer = null;\n\n    this._initNear().then(() => {\n      this.setState({\n        connected: true,\n        signedIn: !!this._accountId,\n        accountId: this._accountId,\n      });\n    });\n  }\n\n  componentDidMount() {\n\n  }\n\n  parseBananaAccount(account, accountId) {\n    if (!account) {\n      account = {\n        accountId,\n        accountIndex: -1,\n        avocadoBalance: 25.0,\n        bananaBalance: 0.0,\n        bananaBalanceBN: new BN(0),\n        numPixels: 0,\n        farmingPreference: Berry.Avocado,\n      }\n    } else {\n      account = {\n        accountId: account.account_id,\n        accountIndex: account.account_index,\n        avocadoBalance: parseFloat(account.avocado_balance) / this._pixelCost,\n        bananaBalance: parseFloat(account.banana_balance) / this._pixelCost,\n        bananaBalanceBN: new BN(account.banana_balance),\n        numPixels: account.num_pixels,\n        farmingPreference: account.farming_preference,\n      }\n    }\n    account.startTime = new Date().getTime();\n    account.avocadoPixels = (account.farmingPreference === Berry.Avocado) ? (account.numPixels + 1) : 0;\n    account.bananaPixels = (account.farmingPreference === Berry.Banana) ? (account.numPixels) : 0;\n    account.avocadoRewardPerMs = account.avocadoPixels / (24 * 60 * 60 * 1000);\n    account.bananaRewardPerMs = account.bananaPixels / (24 * 60 * 60 * 1000);\n    account.bananaRewardPerMsBN = account.bananaBalanceBN.div(new BN(24 * 60 * 60 * 1000));\n    return account;\n  }\n\n  async getAccount(accountId, stats) {\n    const account = this.parseBananaAccount(\n      await this._bananaContract.get_account({account_id: accountId}),\n      accountId\n    );\n    let cucumberAccount = await this._contract.get_account({account_id: accountId});\n    if (!cucumberAccount) {\n      Object.assign(account, {\n        nearBalanceBn: new BN(0),\n        cucumberBalanceBn: new BN(0),\n        nearClaimed: 0,\n      });\n    } else {\n      Object.assign(account, {\n        nearBalanceBn: new BN(cucumberAccount.near_balance),\n        cucumberBalanceBn: new BN(cucumberAccount.cucumber_balance),\n        nearClaimed: parseFloat(cucumberAccount.near_claimed) / Math.pow(10, 24),\n      });\n    }\n    await this._account.fetchState();\n    account.accountNearBalance = parseFloat(this._account._state.amount) / 1e24;\n    account.nearBalance = parseFloat(account.nearBalanceBn.toString()) / Math.pow(10, 24);\n    account.cucumberBalance = parseFloat(account.cucumberBalanceBn.toString()) / this._pixelCost;\n    account.percent = account.cucumberBalance * 100 / stats.totalSupply;\n    return account;\n  }\n\n  async refreshStats(forced) {\n    if (!forced && document.hidden) {\n      return;\n    }\n\n    let currentTime = new Date().getTime();\n    const nextReward = parseFloat(await this._bananaContract.get_next_reward_timestamp()) / 1e6;\n    const lastReward = parseFloat(await this._bananaContract.get_last_reward_timestamp()) / 1e6;\n    const expectedReward = parseFloat(await this._bananaContract.get_expected_reward()) / 1e24;\n    const rawStats = await this._contract.get_stats();\n    const stats = {\n      totalSupplyBn: new BN(rawStats.total_cucumber_balance),\n      totalSupply: parseFloat(rawStats.total_cucumber_balance) / this._pixelCost,\n      totalNearClaimed: parseFloat(rawStats.total_near_claimed) / Math.pow(10, 24),\n      totalNearRewarded: parseFloat(rawStats.total_near_received) / Math.pow(10, 24),\n      timeToNextRewards: nextReward - currentTime,\n      timeFromLastRewards: currentTime - lastReward,\n      expectedReward,\n    };\n    this.setState({\n      stats,\n    })\n  }\n\n  async refreshAccountStats() {\n    await this.refreshStats(true);\n    let account = await this.getAccount(this._accountId, this.state.stats);\n\n    if (this._balanceRefreshTimer) {\n      clearInterval(this._balanceRefreshTimer);\n      this._balanceRefreshTimer = null;\n    }\n\n    this.setState({\n      account,\n    });\n\n    this._balanceRefreshTimer = setInterval(() => {\n      const t = new Date().getTime() - account.startTime;\n      this.setState({\n        account: Object.assign({}, account, {\n          avocadoBalance: account.avocadoBalance + t * account.avocadoRewardPerMs,\n          bananaBalance: account.bananaBalance + t * account.bananaRewardPerMs,\n        }),\n      });\n    }, 100);\n  }\n\n  async _initNear() {\n    const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n    const near = await nearAPI.connect(Object.assign({ deps: { keyStore } }, NearConfig));\n    this._keyStore = keyStore;\n    this._near = near;\n\n    this._walletConnection = new nearAPI.WalletConnection(near, NearConfig.contractName);\n    this._accountId = this._walletConnection.getAccountId();\n\n    this._account = this._walletConnection.account();\n    this._bananaContract = new nearAPI.Contract(this._account, NearConfig.bananaContractName, {\n      viewMethods: ['get_account', 'get_expected_reward', 'get_next_reward_timestamp', 'get_last_reward_timestamp', 'get_account_by_index', 'get_lines', 'get_line_versions', 'get_pixel_cost', 'get_account_balance', 'get_account_num_pixels', 'get_account_id_by_index'],\n      changeMethods: ['transfer_with_vault',],\n    });\n    this._contract = new nearAPI.Contract(this._account, NearConfig.contractName, {\n      viewMethods: ['account_exists', 'get_account', 'get_stats', 'get_near_balance', 'get_total_near_claimed', 'get_total_near_received', 'get_balance', 'get_total_supply'],\n      changeMethods: ['claim_near', 'transfer_raw'],\n    });\n    this._pixelCostBN = new BN(await this._bananaContract.get_pixel_cost());\n    this._pixelCost = parseFloat(this._pixelCostBN.toString());\n    await this.refresh();\n  }\n\n  async requestSignIn() {\n    const appTitle = 'Berry Farm';\n    await this._walletConnection.requestSignIn(\n        NearConfig.contractName,\n        appTitle\n    )\n  }\n\n  async logOut() {\n    this._walletConnection.signOut();\n    this._accountId = null;\n    this.setState({\n      signedIn: !!this._accountId,\n      accountId: this._accountId,\n    })\n  }\n\n  async stakeBananas(bananas) {\n    await this.refreshAccountStats();\n    if (bananas) {\n      bananas = new BN(Math.trunc(bananas * 100000)).mul(this._pixelCostBN).div(new BN(100000));\n    } else {\n      bananas = this.state.account.bananaBalanceBN;\n    }\n    await this._bananaContract.transfer_with_vault({\n      receiver_id: NearConfig.contractName,\n      amount: bananas.toString(),\n      payload: '\"DepositAndStake\"',\n    }, new BN(\"50000000000000\"), new BN(\"1\"))\n  }\n\n  async claimNear() {\n    this.setState({\n      claiming: true\n    });\n    await this._contract.claim_near();\n    await this.refreshAccountStats();\n    this.setState({\n      claiming: false\n    });\n  }\n\n  async refresh() {\n    if (this._accountId) {\n      await this.refreshAccountStats();\n    } else {\n      await this.refreshStats(true);\n    }\n  }\n\n  render() {\n    const account = this.state.account;\n    const fraction = 3;\n    const content = !this.state.connected ? (\n        <div>Connecting... <span className=\"spinner-grow spinner-grow-sm\" role=\"status\" aria-hidden=\"true\"></span></div>\n    ) : (this.state.signedIn ? (\n        <div>\n          <div className=\"float-right\">\n            <button\n              className=\"btn btn-outline-secondary\"\n              onClick={() => this.logOut()}>Log out ({this.state.accountId})</button>\n          </div>\n          <div>\n            { account ? (\n              <div className=\"lines\">\n                <div>\n                  <h3>Your Balances</h3>\n                  <button\n                    className=\"btn\"\n                    onClick={() => this.refreshAccountStats()}\n                  >\n                    Refresh\n                  </button>\n                </div>\n                <div className=\"balances\">\n                  {Avocado}{' '}{account.avocadoBalance.toFixed(fraction)}\n                  {(account.avocadoPixels > 0) ? (\n                    <span>\n                      {' (+'}{account.avocadoPixels}{Avocado}{'/day)'}\n                    </span>\n                  ) : \"\"}\n                </div>\n                <div className=\"balances\">\n                  {Banana}{' '}{account.bananaBalance.toFixed(fraction)}\n                  {(account.bananaPixels > 0) ? (\n                    <span>\n                      {' (+'}{account.bananaPixels}{Banana}{'/day)'}\n                    </span>\n                  ) : \"\"}\n                </div>\n                <div>\n                  <div>\n                    <span className=\"balances label-for-swap\">{Banana}</span>\n                    <InputNumber\n                      className=\"balances swap-input\"\n                      min={0.001}\n                      max={this.state.account.bananaBalance}\n                      value={this.state.bananaNum}\n                      onChange={(bananaNum) => this.setState({bananaNum})}\n                      enableMobileNumericKeyboard\n                    />\n                    <button\n                      className={\"btn-max balances\"}\n                      disabled={account.bananaBalance === 0}\n                      onClick={() => this.setState({bananaNum: ''})}\n                    >\n                      MAX\n                    </button>\n\n                  <Swap\n                    account={this.state.account}\n                    stakeBananas={(b) => this.stakeBananas(b)}\n                    amount={this.state.bananaNum}\n                  />\n                  </div>\n                </div>\n                <div className=\"balances\">\n                  {Cucumber}{' '}{account.cucumberBalance.toFixed(fraction)}{' ('}{account.percent.toFixed(fraction)}{'% share)'}\n                </div>\n                <div className=\"balances\">\n                  {Near}{' '}{account.accountNearBalance.toFixed(fraction)}\n                </div>\n                <div>\n                  <button\n                    className={\"btn btn-success\" + ((account.nearBalance > 0) ? \" btn-large\" : \" hidden\")}\n                    disabled={this.state.claiming}\n                    onClick={() => this.claimNear()}\n                  >\n                    Claim {account.nearBalance.toFixed(fraction)} {Near}\n                  </button>\n                </div>\n              </div>\n            ) : \"\"}\n            </div>\n        </div>\n    ) : (\n        <div style={{marginBottom: \"10px\"}}>\n          <button\n              className=\"btn btn-primary\"\n              onClick={() => this.requestSignIn()}>Log in with NEAR Wallet</button>\n        </div>\n    ));\n    const stats = this.state.stats;\n    const statsContent = stats ? (\n        <div>\n          <div>\n            <h3>Rewards</h3>\n            <button\n              className=\"btn\"\n              onClick={() => this.refresh()}\n            >\n              Refresh\n            </button>\n          </div>\n          <div className=\"lines\">\n            <div>\n              Berry Club distributes rewards at most once per minute\n            </div>\n            {account ? (\n              <div>\n                <div>\n                  <span className=\"label\">Your next reward {Near}</span>\n                  <span className=\"balances\">{(stats.expectedReward * account.percent / 100).toFixed(6)}</span>\n                </div>\n                <div>\n                  <span className=\"label\">Total earned {Near}</span>\n                  <span className=\"balances\">\n                    {(account.nearClaimed + account.nearBalance).toFixed(6)}\n                  </span>\n                </div>\n              </div>\n              ): \"\"}\n            <div>\n              <span className=\"label\">{(stats.timeToNextRewards > 0) ? \"Time until next reward\" : \"Time from last reward\"}</span>\n              <span className={\"balances\" + ((stats.timeToNextRewards < 0) ? \" red\" : \"\")}>\n                <Timer\n                  key={stats.timeToNextRewards}\n                  initialTime={(stats.timeToNextRewards > 0) ? stats.timeToNextRewards : stats.timeFromLastRewards}\n                  direction={(stats.timeToNextRewards > 0) ? \"backward\" : \"forward\"}\n                  timeToUpdate={100}\n                  lastUnit=\"h\"\n                  checkpoints={[\n                    {\n                      time: 0,\n                      callback: () => this.refreshStats(),\n                    },\n                  ]}\n                >\n                  {() => (\n                    <React.Fragment>\n                      <Timer.Hours />:\n                      <Timer.Minutes formatValue={v => `${v}`.padStart(2, '0')}/>:\n                      <Timer.Seconds formatValue={v => `${v}`.padStart(2, '0')} />.\n                      <Timer.Milliseconds formatValue={v => `${v}`.padStart(3, '0')} />\n                    </React.Fragment>\n                  )}\n                </Timer>\n              </span>\n            </div>\n            {(stats.timeToNextRewards < 0) ? (\n              <div className=\"larger font-weight-bold\">\n                Use {Avocado} to draw a pixel on berry club to distribute {Near} rewards.\n              </div>\n            ) : \"\"}\n          </div>\n          <div>\n            <h3>Global stats</h3>\n            <button\n              className=\"btn\"\n              onClick={() => this.refresh()}\n            >\n              Refresh\n            </button>\n          </div>\n          <div className=\"lines\">\n            <div>\n              <span className=\"label\">Next reward {Near}</span>\n              <span className=\"balances\">{stats.expectedReward.toFixed(6)}</span>\n            </div>\n            <div>\n              <span className=\"label\">Total {Cucumber} Supplied</span>\n              <span className=\"balances\">{stats.totalSupply.toFixed(3)}</span>\n            </div>\n            <div>\n              <span className=\"label\">Total {Near} Rewarded</span>\n              <span className=\"balances\">{stats.totalNearRewarded.toFixed(6)}</span>\n            </div>\n            <div>\n              <span className=\"label\">Total {Near} Claimed</span>\n              <span className=\"balances\">{stats.totalNearClaimed.toFixed(6)}</span>\n            </div>\n\n          </div>\n        </div>\n      ) : \"\";\n    return (\n        <div className=\"container\">\n          <div className=\"row\">\n            <div>\n              <div>\n              <h2>Berry Farm {Cucumber}</h2>\n              <a\n                className=\"btn btn-outline-none\"\n                href=\"https://berryclub.io\">{Avocado} Berry Club {Banana}\n              </a>\n              </div>\n              <div className=\"call-to-action\">\n                Swap {Banana} to stake {Cucumber} to farm {Near}\n              </div>\n              {content}\n              {statsContent}\n              <div>\n              </div>\n            </div>\n          </div>\n        </div>\n    );\n  }\n}\n\nconst Swap = (props) => {\n  return (\n    <button\n      className={\"btn btn-large\" + (props.amount === 0 ? \" btn-success\" : \"\")}\n      disabled={props.account.bananaBalance < props.amount}\n      onClick={() => props.stakeBananas(props.amount)}\n    >\n      Swap <span className=\"font-weight-bold\">{props.amount || \"ALL\"}{Banana}</span> to <span className=\"font-weight-bold\">{Cucumber}</span>\n    </button>\n  );\n}\n\n/*\nconst Account = (props) => {\n  const accountId = props.accountId;\n  const shortAccountId = (accountId.length > 6 + 6 + 3) ?\n    (accountId.slice(0, 6) + '...' + accountId.slice(-6)) :\n    accountId;\n  return <a className=\"account\"\n            href={`https://wayback.berryclub.io/${accountId}`}>{shortAccountId}</a>\n}\n*/\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}